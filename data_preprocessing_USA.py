import pandas
import matplotlib.pyplot as plt
import math
import numpy as np
from scipy import interpolate

#Days per Month per Year
days_2020 = [31, 29, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
N_2020 = sum(days_2020);
days_2021 = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
N_2021 = sum(days_2021);
days_2022 = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
N_2022 = sum(days_2022);
days_2023 = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
N_2023 = sum(days_2023);
days_2024 = [31, 29, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
N_2024 = sum(days_2024);
N_total = N_2020 + N_2021 + N_2022 + N_2023 + N_2024;

dates_in_month = {2020: days_2020, 2021: days_2021, 2022: days_2022, 2023: days_2023, 2024: days_2024};
month_dict = {'Jan': 1, 'Feb': 2, 'Mar': 3, 'Apr': 4, 'May': 5, 'Jun': 6, \
              'Jul': 7, 'Aug': 8, 'Sep': 9, 'Oct': 10, 'Nov': 11, 'Dec': 12};

##### EDIT HERE #####
country_ID = "USA";
calendar_start = "2020-03-01";
calendar_target = "2024-04-12";
N_p = 339.1*(10**6); #as of 1 January 2020 (WPP UN data)
save_data = True;
####################

def date_to_index(target_calendar, user_calendar_start = "2020-02-01"):
    default_calendar_start = "2020-01-01";
    default_year_start = 2020;
    default_month_start = 1;
    default_date_start = 1;
    default_index_start = 0;
    
    user_year_start = int(user_calendar_start.split('-')[0]);
    user_month_start = int(user_calendar_start.split('-')[1]);
    user_date_start = int(user_calendar_start.split('-')[2]);
    n_days_previous_years = sum([sum(dates_in_month[i])   for i in range(2020, user_year_start)]);
    n_days_in_user_year = sum([dates_in_month[user_year_start][i] for i in range(user_month_start-1)]) + user_date_start;
    n_days_since_default_start = n_days_previous_years + n_days_in_user_year;
    user_index_start = n_days_since_default_start - 1;

    target_year = int(target_calendar.split('-')[0]);
    target_month = int(target_calendar.split('-')[1]);
    target_date = int(target_calendar.split('-')[2]);
    n_days_previous_years = sum([sum(dates_in_month[i])   for i in range(2020, target_year)]);
    n_days_in_user_year = sum([dates_in_month[target_year][i] for i in range(target_month-1)]) + target_date;
    n_days_since_default_start = n_days_previous_years + n_days_in_user_year;
    target_index_start = n_days_since_default_start - 1; 
 
    return target_index_start - user_index_start


start_year = int(calendar_start.split("-")[0]);
start_month = int(calendar_start.split("-")[1]);
start_date = int(calendar_start.split("-")[2]);
target_year = int(calendar_target.split("-")[0]);
target_month = int(calendar_target.split("-")[1]);
target_date = int(calendar_target.split("-")[2]);
index_start = 0;
index_target = date_to_index(calendar_target, user_calendar_start = calendar_start);

dt = 1/100;
N_samples = int(index_target/dt);
t_samples = [0 + dt*i for i in range(N_samples+1)];


################################################


############## ACTIVE CASES ###########################
df_calendar = pandas.read_csv("calendar_active_cases.csv");
cal_act = df_calendar;
#Active Cases collected from Worldometers.info
active_case = [12,12,12,12,12,10,29,29,28,48,51,54,54,57,60,65,85,106,138,200,289,401,504,663,949,1248,2367,3102,3895,4905,6228,8645,12359,17654,24121,29864,39902,51101,63615,78180,94911,113985,131400,148237,169455,188888,210355,232464,258571,284031,301350,324103,348561,372305,395173,418940,435904,448661,460101,477272,495175,504255,524766,533981,543917,560004,571898,592609,614083,612442,628833,644553,654445,669672,687020,703824,720966,727303,737419,738110,743860,750193,766463,778222,779108,785261,791055,780877,777622,791561,801970,811457,818661,825162,830821,836889,842972,804155,809640,812744,809871,802418,799499,799891,802981,805675,751066,747059,727938,697869,693112,696312,699814,700618,697850,695079,685165,690361,682281,688058,685702,682012,689231,688105,698683,698186,712500,724861,731965,745465,756801,781699,807735,834406,858399,873617,895207,928289,963514,1002087,1035069,1063014,1081640,1116097,1157307,1193755,1241578,1282408,1321655,1359356,1387350,1427218,1472666,1495861,1533133,1575431,1592940,1628482,1652597,1685500,1716764,1754087,1779392,1793892,1812569,1835175,1858411,1886710,1909230,1935955,1914817,1931629,1936105,1951808,1968057,1993608,2013872,2006832,2017927,2022519,2033436,2052357,2070705,2080769,2068131,2067437,2066116,2066740,2075118,2087412,2092510,2077313,2072068,2053299,2052182,2061044,2062646,2069066,2071064,2062270,2050437,2053177,2014194,2019330,2022563,2005810,1989085,1970762,1963378,1962053,1965644,1965760,1941731,1934051,1918685,1921524,1925516,1931878,1931992,1913792,1898200,1884548,1884776,1885746,1879119,1875757,1858801,1857033,1847435,1852179,1855339,1859467,1860420,1850025,1853911,1856756,1867361,1882592,1907565,1909529,1899948,1905369,1912590,1931099,1922352,1947478,1966029,1972863,1994838,2001901,2026767,2062026,2098456,2124933,2129686,2161277,2186054,2224679,2279181,2324715,2362450,2377016,2427894,2482453,2556173,2631558,2711917,2784587,2825802,2922401,3017464,3099089,3211948,3307030,3402932,3466513,3561303,3656876,3765742,3881900,3974321,4060612,4122279,4209140,4181003,4279122,4326206,4371423,4439613,4469683,4529736,4598458,4701912,4817357,4908928,4995284,5036597,5119603,5190084,5281353,5318320,5407211,5482157,5502206,5536524,5598091,5671997,5776238,5826518,5903459,5883852,5918899,5960274,6007049,6070383,6077574,6088984,6035805,6053446,6091910,6163257,6279590,6327238,6407102,6283866,6348250,6413924,6508793,6645170,6761184,6834602,6811573,6852415,6901734,6925631,6997373,7044056,7070961,7029965,6947828,6912300,6905787,6907557,6918260,6909627,6812169,6775570,6717615,6657333,6613573,6547174,6498895,6364286,6283907,6195989,6090584,6040123,5960890,5891944,5780010,5672084,5525603,5454445,5376709,5293243,5199866,5060118,4949295,4856384,4742853,4654485,4539960,4443918,4314339,4217644,4128080,4028623,3950966,3859369,3784971,3692473,3614535,3533574,3474824,3416454,3338959,3275131,3196470,3121179,3063287,3015495,2954425,2912188,2872115,2808832,2762093,2723958,2696295,2662083,2634468,2602493,2547997,2519868,2496037,2485586,2471751,2466185,2449793,2422348,2412463,2400546,2396590,2397826,2406397,2404721,2381393,2367856,2367443,2375096,2386594,2383927,2385467,2367638,2380257,2388691,2387680,2400601,2410846,2407659,2382423,2380053,2369964,2370212,2373186,2375149,2370291,2341566,2329886,2315485,2307854,2289680,2281310,2270209,2229033,2205586,2182551,2145259,2130176,2111791,2091097,2045290,2013129,1973465,1950980,1926669,1891032,1866616,1820100,1791716,1767045,1731744,1709900,1687392,1665371,1621567,1596189,1557685,1533742,1513784,1489036,1469134,1448408,1393778,1360277,1335095,1313516,1294817,1277929,1235547,1199163,1178571,1158692,1138478,1030727,1012257,983906,964289,945015,930509,909880,887971,867303,842463,830703,820208,812623,804442,794671,787478,774664,767269,767846,762255,761066,761156,761521,758689,755322,757875,766942,779127,790540,798912,799152,817518,839887,865290,893484,922777,947060,962833,993852,1039539,1086702,1144039,1196996,1242170,1272927,1337820,1408288,1487231,1574175,1653533,1719636,1768047,1845446,1945613,2050664,2160634,2256694,2336011,2389412,2481810,2594301,2702340,2824857,2932584,3013951,3058156,3148203,3250950,3368785,3493823,3596840,3683320,3717118,3811627,3919483,4036016,4164373,4263009,4339289,4368650,4446575,4499358,4592729,4694991,4751294,4807015,4813499,4829579,4835872,4900525,4964830,5017812,5057658,5024622,5031453,5058465,5102239,5130438,5142710,5136277,5055056,5031674,5018937,5016406,5013978,4998654,4957776,4875923,4825908,4788784,4772820,4746764,4663905,4619543,4512461,4454069,4418517,4389419,4339352,4287557,4239416,4142775,4052334,3993747,3951319,3903526,3858920,3803560,3703582,3616116,3557070,3521563,3460907,3411375,3355536,3250363,3199120,3143384,3116232,3076808,3043678,3005666,2936485,2865150,2823167,2808237,2786283,2769468,2745499,2672829,2655082,2636402,2647147,2638414,2642299,2641807,2615592,2618273,2613083,2644519,2664984,2682424,2691014,2658191,2676387,2693164,2695988,2676837,2656668,2641373,2632225,2644179,2677747,2738796,2792977,2839939,2866673,2864732,2906786,2936969,2983614,3025782,3062000,3088112,3011916,3021690,3059087,3121252,3190946,3256765,3320430,3359024,3445241,3546245,3749553,3990331,4186415,4326803,4480820,4675138,5018442,5501872,6009381,6490005,6879317,7246781,7638641,8209405,8878654,9607127,10254054,10869472,11314168,11826352,12487054,13168113,13809359,14393506,14920016,15293492,15469608,15788825,16260711,16779402,17204145,17460053,17496316,17548916,17694746,17888577,18047140,18122069,18138588,18029916,17736590,17441769,17344901,17142223,16928131,16688829,16383518,15956714,15614230,15288693,14890820,14476565,14137563,13554142,13179442,12753124,12330583,11891584,11459891,11008545,10443974,10006741,9565809,9098608,8650237,8242162,7860863,7417114,7090505,6748828,6404085,6035214,5677999,5376276,5091686,4826478,4580035,4338332,4101619,3877038,3677146,3477788,3324889,3181821,3011161,2865267,2738427,2657001,2530009,2426144,2336691,2236392,2084006,2008974,1941752,1828543,1763522,1696762,1647644,1607101,1575856,1520452,1475579,1444104,1425735,1405529,1394389,1383046,1348013,1331013,1311902,1316320,1326047,1340090,1342483,1336542,1328230,1332061,1351263,1376914,1405868,1425332,1436516,1440592,1451958,1478627,1523886,1566657,1599435,1614763,1630803,1655649,1699272,1762493,1821235,1883201,1931252,1934566,1978415,2031191,2100178,2169001,2233888,2278396,2325455,2370327,2434442,2522648,2596334,2662235,2708189,2723691,2759277,2815851,2883842,2949014,3039846,3028694,3060715,3048960,3063174,3118115,3179239,3228734,3260993,3261599,3284239,3303584,3342715,3384082,3415345,3420303,3415302,3416484,3428019,3455667,3477322,3501942,3479723,3472075,3483291,3489458,3547350,3582539,3611632,3619168,3614484,3616626,3640334,3695600,3746441,3795824,3771939,3738969,3712491,3708046,3751838,3810111,3903000,3986593,3850187,3867977,3896328,3945493,3997235,4028128,4051798,4044895,4058410,4089299,4135078,4167024,4182891,4178214,4157833,4181197,4196920,4229126,4262087,4284148,4266428,4250725,4256602,4251544,4276030,4277660,4266266,4238217,4186190,4188103,4174009,4182591,4159352,4134607,4097015,4036034,4004095,4014130,3990698,3952192,3960844,3878459,3832790,3804556,3780851,3765916,3736740,3706035,3678008,3610954,3583417,3523356,3497901,3469238,3437338,3386763,3327800,3276465,3237002,3195657,3177847,3135977,3106071,3056207,3002406,2961206,2897724,2883731,2839034,2803130,2762213,2720777,2693013,2631405,2608943,2569859,2545297,2482548,2463437,2420644,2369596,2340813,2311677,2268759,2227119,2197307,2152836,2108057,2086759,2073950,2020476,2007696,1960825,1938004,1909994,1895714,1883419,1851371,1819987,1796182,1795001,1778874,1767414,1754178,1736487,1722407,1737319,1700818,1690573,1688599,1670882,1661611,1653990,1647297,1656437,1646240,1635633,1659136,1636404,1626401,1631928,1638634,1645716,1658972,1664666,1662968,1661896,1625068,1639741,1630751,1632367,1650429,1666844,1637006,1653299,1665661,1667944,1667758,1688214,1686500,1692094,1730297,1756556,1762278,1793639,1838126,1871595,1891533,1902526,1943353,1964151,1997209,2035514,2050103,2067845,2098496,2115851,2137310,2176136,2223203,2249879,2231882,2255943,2265242,2280208,2305124,2347312,2348590,2346976,2345223,2377279,2380960,2412469,2452331,2476218,2465536,2462210,2458573,2475329,2493712,2534852,2485745,2494824,2520871,2535790,2514407,2491994,2484728,2435310,2436987,2437384,2359904,2313735,2311534,2346639,2258017,2252726,2257473,2256362,2209095,2218121,2224703,2212188,2197701,2205790,2195029,2143309,2142255,2142013,2160381,2143705,2077217,2020283,1972025,1966372,1978920,1986367,1979846,1959811,1947920,1924427,1926943,1942334,1913990,1910300,1903743,1884161,1859868,1860405,1853754,1866320,1859777,1866159,1834929,1822112,1795157,1805230,1824585,1813164,1763751,1713093,1710292,1693538,1714712,1703592,1661371,1589820,1563574,1546486,1495297,1462633,1430114,1419125,1423522,1390482,1355545,1361937,1372157,1369606,1370346,1360758,1330580,1298724,1272336,1274189,1282305,1278877,1273287,1260061,1236758,1236518,1220068,1223381,1219161,1217269,1197926,1193669,1189361,1194252,1199563,1191549,1198537,1184519,1150500,1133920,1130967,1139351,1139921,1145710,1124623,1131189,1126850,1125717,1124484,1120824,1107990,1068219,1042541,1043604,1051715,1044462,1042221,1049398,1041523,1032974,1037318,1041917,1043226,1024333,1025156,987379,979504,897309,816107,813411,818455,811104,806771,784554,776827,782471,771984,772943,770687,759672,757732,761158,763734,731558,721277,724287,720730,712400,713763,717590,715777,713498,716458,719005,721246,721046,706449,705810,704384,708305,695981,689540,689159,691641,691825,694550,695833,698619,695622,696446,698332,699552,697393,698515,691447,687229,690114,693275,691894,694405,698285,699645,699295,702973,699230,702289,706088,710982,711518,712083,717221,722211,726419,731141,734981,736227,739482,748046,755786,759277,765568,773249,777769,782255,791998,799981,808148,814223,824806,824422,797485,801437,811096,820278,829030,841250,843832,857476,873960,883700,895934,910027,925350,932696,948366,960377,976103,990129,1002260,1022381,1028394,1034920,1046512,1063077,1077162,1090740,1100938,1099114,1109879,1129869,1137906,1141720,1152188,1161033,1164107,1168362,1172506,1182580,1183542,1182195,1187657,1184527,1175310,1177064,1180386,1183256,1179639,1179605,1169845,1156091,1145018,1128605,1122510,1122041,1119516,1109154,1092982,1083661,1077383,1076407,1072163,1064424,1053877,1035743,1031955,1033268,1032900,1031722,1025727,1018545,1008315,1001222,997835,1000655,1001242,1002879,997147,982462,971319,971936,976075,981651,989359,973613,958153,950126,955586,961378,963493,969069,963884,961306,958446,965454,972976,979850,987439,973295,973765,986277,988791,984845,982900,973485,968101,967995,971287,979831,987081,986378,999038,987165,988344,995306,1007308,1017148,1017275,1027024,1029091,1026714,1033696,1048123,1061743,1072541,1084063,1072774,1075035,1085173,1101182,1117093,1132935,1148657,1143829,1148601,1163693,1186076,1196082,1210576,1217083,1232243,1216899,1236565,1253088,1273136,1282616,1297670,1284047,1282010,1283384,1296440,1313920,1331287,1351859,1333992,1328146,1345786,1336379,1352885,1369147,1378151,1364237,1351804,1356878,1372087,1377027,1385366,1388758,1360020,1351149,1357437,1372380,1372098,1380435,1383504,1373436,1362288,1377433,1367120,1380066,1388931,1397145,1349716,1359689,1371343,1382636,1370665,1331863,1295456,1276578,1245279,1192508,1191926,1186545,1179469,1183820,1172290,1167874,1171011,1174870,1181103,1179195,1153813,1111894,1102130,1091785,1088071,1086356,1079896,1078008,1047030,1041576,1028037,1034375,1037765,1036629,1030915,1000778,989820,971272,975734,978970,958199,960296,927807,923387,900639,904597,897901,897528,895783,869386,864197,862876,864393,866988,865625,863078,823988,820008,816574,810783,810713,809739,809153,801824,795132,786167];
n_active_case = len(active_case);
##
calendar = [i.split(" ")[2]+"-"+str(month_dict[i.split(" ")[0]])+"-"+i.split(" ")[1][0:-1] \
            for i in df_calendar.columns];
n_calendar = len(calendar);
active_case = active_case[0:n_calendar];
n_active_case = len(active_case);
index_active_case = [date_to_index(i, user_calendar_start = calendar_start) for i in calendar];
##
##

################# TOTAL CASES ###########################
df_calendar = pandas.read_csv("calendar_total_cases.csv");
#Total Cases collected from Worldometers.info
total_case = [15,15,15,15,15,15,35,35,35,53,57,60,60,63,68,75,100,124,158,221,319,435,541,704,994,1301,2435,3176,4020,5059,6420,8899,12664,18020,24616,30478,40728,52250,65173,80124,98809,119173,139329,160031,184051,210748,238628,267418,301599,334929,362117,393591,427704,460657,494920,529165,559920,586293,613800,643601,675786,706633,740525,770189,796413,825176,852745,884586,919218,954019,989480,1017204,1041494,1068499,1098934,1130259,1165921,1194709,1221319,1246231,1271953,1297879,1327759,1357123,1382629,1403211,1422013,1446432,1469456,1496485,1524973,1549483,1570341,1593393,1615764,1639511,1667122,1692714,1715075,1735172,1753758,1772704,1794236,1818485,1844255,1868793,1889779,1908315,1932300,1953703,1977030,2002701,2025966,2046177,2064821,2085315,2107567,2131382,2157992,2184311,2204494,2225834,2253747,2282200,2311080,2346852,2382139,2410574,2443311,2481555,2521986,2565198,2614326,2660957,2703642,2746674,2797363,2853344,2914971,2977396,3031443,3077603,3129566,3190073,3257295,3323238,3398951,3464328,3525828,3590699,3660442,3737151,3812918,3890812,3958586,4022211,4084323,4154832,4230010,4302233,4382810,4456508,4512260,4570868,4639513,4709303,4778912,4853386,4915770,4965207,5012869,5069572,5128335,5187825,5253417,5313060,5361224,5410587,5467701,5525681,5580866,5644196,5700841,5740420,5781561,5827401,5874711,5921549,5974887,6020931,6057524,6097016,6140507,6186906,6233155,6283368,6328703,6363944,6400858,6443597,6487534,6533538,6587773,6632799,6665261,6690331,6719914,6757252,6797602,6846693,6890097,6923175,6959329,6999063,7041736,7089022,7139149,7184887,7219301,7254921,7292872,7336762,7383180,7435257,7480488,7514324,7551858,7596338,7640557,7687925,7739904,7788278,7824453,7864181,7911266,7962614,8022769,8083834,8140719,8184708,8232011,8287894,8348126,8415234,8487469,8550949,8599902,8656062,8722298,8791273,8868767,8951166,9033665,9097088,9167531,9247574,9333597,9428125,9531424,9623621,9701693,9789819,9892212,10006934,10136855,10271751,10408071,10522019,10643846,10798136,10950526,11117430,11303760,11470673,11620895,11776378,11949603,12127326,12327016,12531766,12716891,12869047,13037627,13225226,13411904,13579309,13738044,13890544,14042705,14206613,14395116,14609066,14836523,15076614,15297541,15480969,15673663,15892536,16120270,16353208,16601534,16832364,17026763,17229303,17438921,17694549,17935212,18186865,18397376,18589358,18790504,18998054,19231464,19447379,19612713,19780545,19929152,20116493,20326388,20559405,20811529,21049478,21292219,21496860,21700529,21943547,22211806,22493272,22804358,23069927,23297483,23519540,23751744,23992669,24224207,24472826,24686204,24869011,25023146,25199944,25389080,25586442,25784820,25961824,26107947,26259282,26414795,26574395,26742644,26910399,27060234,27176215,27305006,27421715,27541205,27665375,27799437,27909899,28004048,28093360,28190761,28289580,28395831,28497942,28586484,28652908,28707531,28769183,28840592,28909065,28992461,29064996,29123322,29181876,29254468,29330596,29407077,29488092,29554402,29608640,29662900,29720662,29787928,29855607,29925536,29985894,30030763,30075147,30130629,30190402,30253098,30320691,30373785,30417800,30462829,30515701,30578874,30642583,30708381,30768161,30815958,30862036,30921660,30988535,31055183,31131696,31197469,31252608,31309779,31374282,31444910,31521786,31596549,31667185,31717431,31771848,31835520,31910494,31991108,32075493,32149064,32208004,32262126,32340856,32419478,32493806,32575588,32648504,32702412,32752552,32813548,32878891,32945279,33011755,33070118,33114682,33160637,33212674,33269062,33328180,33387850,33439328,33477479,33515879,33558127,33604547,33652395,33701515,33741195,33769532,33797276,33831913,33867978,33906837,33944539,33974080,33997644,34021180,34048854,34078356,34108798,34137656,34162406,34179785,34198255,34221478,34245765,34269551,34292415,34309100,34321824,34330878,34343232,34359387,34377285,34395816,34412140,34424223,34438237,34452586,34468441,34484851,34501026,34514360,34524201,34535167,34548032,34562532,34576827,34590918,34602899,34611695,34621658,34635024,34650941,34666835,34682964,34695897,34706175,34718345,34732707,34750664,34769089,34787766,34804447,34817589,34829868,34844894,34867837,34895083,34925137,34950175,34971474,34995009,35029011,35068186,35108720,35153417,35195803,35231438,35268406,35318912,35382262,35448781,35523853,35591413,35647961,35701463,35787324,35878517,35978022,36088623,36182854,36263196,36342897,36457879,36583361,36716041,36857297,36982565,37085116,37185599,37320301,37470035,37622549,37788853,37931838,38044601,38157199,38308343,38474711,38647155,38834764,38990335,39115161,39235961,39396215,39581585,39763669,39963588,40131640,40266966,40402543,40574080,40766795,40954811,41148678,41305378,41441854,41569351,41688539,41849614,42025428,42208492,42370778,42504751,42618336,42772261,42942372,43104750,43270145,43403841,43504501,43603026,43735953,43873358,44009325,44147098,44258791,44346771,44435339,44547089,44672103,44797114,44921536,45021414,45097983,45175239,45280201,45392829,45502859,45612577,45696696,45766863,45831570,45922944,46023567,46122203,46218748,46292927,46349213,46409505,46488950,46572107,46659827,46745510,46814091,46864008,46920902,47000347,47081133,47168510,47253506,47321021,47372952,47435396,47511945,47591589,47682515,47770715,47841922,47900536,47960767,48044400,48140545,48237669,48336845,48418376,48483958,48557993,48658208,48765535,48881351,48995581,49087012,49153182,49231362,49340091,49446738,49532854,49605563,49668425,49728419,49808794,49931795,50065998,50216247,50367402,50487221,50574487,50672559,50799685,50930821,51068048,51211435,51330283,51422090,51524254,51648687,51792568,51954805,52128267,52287368,52424819,52584573,52780979,53024553,53321499,53644929,53918448,54142909,54398586,54750378,55242138,55855504,56489677,57093679,57598185,58127383,58744443,59480979,60315311,61229723,62058257,62834313,63555812,64320568,65221633,66122774,67021857,67813490,68538621,69177895,69803928,70553784,71321680,72154811,72840123,73361079,73869696,74371663,74925473,75488520,76035815,76439757,76744025,77034412,77342197,77666334,77971376,78283066,78490391,78637722,78799016,78997718,79217294,79412123,79579216,79708820,79799547,79887973,79998405,80112890,80226162,80344099,80428516,80484932,80540975,80606079,80681924,80764492,80840904,80893702,80929817,80966827,81014644,81065260,81118085,81164727,81202056,81226757,81255472,81290013,81329183,81372331,81413266,81440052,81457942,81479622,81510107,81541946,81580052,81613301,81637509,81657102,81677476,81706271,81739253,81774915,81810176,81839369,81857722,81878517,81906643,81938758,81976971,82010637,82037789,82058549,82082005,82111499,82151295,82191995,82233475,82265896,82294179,82324309,82360557,82404010,82453727,82504949,82546216,82577332,82612878,82653649,82711649,82772648,82838572,82892060,82935127,82982866,83036975,83103883,83179924,83257647,83322682,83374337,83430058,83494788,83577790,83671918,83771274,83857064,83924354,84003224,84087286,84188697,84306819,84422208,84527224,84613068,84709488,84809090,84932079,85066433,85197678,85308777,85401191,85491984,85595210,85724979,85858722,85988843,86093334,86189559,86270139,86347957,86457654,86582385,86719226,86837850,86931115,87024272,87134426,87257852,87382643,87510791,87612954,87696980,87783656,87883216,87999157,88112855,88224919,88321632,88408941,88483615,88589894,88709784,88853154,88987331,89099510,89193832,89282263,89389403,89520988,89660192,89802466,89916609,90011836,90096784,90180223,90297140,90440073,90594621,90730489,90840083,90943912,91076389,91221316,91373209,91526921,91655515,91767487,91872295,91998712,92147293,92301089,92452459,92580401,92683694,92784957,92911921,93053179,93199344,93343182,93460155,93562008,93659854,93779095,93911911,94042498,94174337,94278274,94363713,94446744,94554924,94675622,94798193,94917827,95015041,95092803,95165483,95260241,95372671,95478964,95592658,95682446,95755858,95828222,95919127,96026403,96132446,96237136,96327102,96398224,96464175,96555852,96650816,96748909,96840558,96914635,96972708,97026038,97082027,97152616,97228204,97311841,97376817,97431029,97481391,97548255,97617670,97687146,97755264,97812250,97854810,97900075,97956920,98020734,98080710,98140835,98189241,98227203,98265906,98314145,98367371,98420223,98473521,98516402,98549178,98587477,98628781,98679658,98726064,98774285,98814155,98844314,98876613,98912497,98959039,99002942,99047430,99085916,99117139,99148695,99187536,99228724,99271990,99314504,99351808,99382527,99414743,99454288,99498006,99543641,99590061,99630619,99661505,99694479,99732817,99776087,99824223,99871342,99912545,99947292,99982424,100023933,100071034,100117295,100162011,100198188,100229879,100264324,100306139,100351836,100401125,100449870,100492279,100528199,100563813,100606772,100658941,100708013,100747991,100784891,100826191,100866387,100924250,100996231,101071879,101149935,101215848,101273063,101330272,101397241,101474574,101547836,101621005,101687278,101743087,101800639,101867832,101944773,102023793,102097299,102167336,102226217,102285242,102354367,102430699,102507825,102580332,102644040,102697347,102747100,102800857,102870343,102945961,103023343,103091037,103148948,103202630,103258206,103328468,103402444,103475182,103539574,103594028,103650318,103711284,103775960,103833578,103888277,103935969,103976001,104015033,104060011,104109677,104159996,104206916,104251455,104291232,104328779,104372418,104418674,104465725,104511490,104553119,104589077,104624562,104665184,104711129,104755860,104800323,104840525,104874890,104909209,104948332,104991485,105033971,105075673,105112206,105144752,105177170,105215998,105256357,105295427,105333272,105370631,105401987,105431251,105465793,105503682,105540627,105577408,105608543,105637219,105664852,105699939,105733978,105763705,105794333,105820336,105843146,105865675,105893375,105921323,105948685,105975584,105999624,106020680,106040689,106065804,106092119,106115511,106138505,106158988,106176860,106194550,106217921,106240207,106263709,106286108,106307289,106325513,106343165,106363748,106384793,106407527,106427109,106445532,106462102,106477995,106497050,106517658,106537379,106554816,106569397,106582919,106596240,106611871,106629700,106646699,106664036,106678561,106692145,106704972,106719922,106735595,106751364,106767592,106781504,106793916,106806251,106819262,106835168,106847641,106859642,106870606,106880271,106889202,106900570,106913136,106925484,106936284,106946325,106955018,106963071,106973416,106983990,106993526,107002320,107011416,107020411,107029899,107040291,107050498,107060078,107069576,107077527,107083708,107090424,107098729,107106995,107114502,107123034,107130052,107135891,107141583,107147894,107155901,107164445,107172358,107179615,107185800,107191807,107199602,107207437,107214275,107220905,107227519,107232505,107237296,107244937,107251916,107258588,107264694,107270275,107275098,107279985,107285978,107292778,107300400,107307562,107314206,107319894,107326724,107334379,107342040,107349050,107356464,107363114,107368624,107374406,107381200,107387131,107394089,107401587,107408859,107414775,107421049,107428708,107436562,107444261,107452676,107459936,107466765,107474546,107483210,107492645,107502503,107511920,107521241,107529693,107538506,107548373,107557942,107569044,107581320,107592706,107603034,107614872,107627099,107640582,107653625,107667587,107681194,107694029,107706322,107721718,107737721,107753758,107770435,107786331,107801063,107815463,107833780,107852538,107872716,107894943,107915680,107934745,107953952,107977196,108001784,108027281,108053008,108076924,108098140,108119712,108146948,108173164,108199346,108226157,108251358,108273294,108294403,108316041,108342953,108371286,108400974,108426296,108447617,108469477,108493817,108517331,108541488,108564380,108585268,108603577,108623067,108644214,108663703,108684254,108705083,108723793,108740867,108758444,108776578,108794951,108815318,108833306,108851364,108866378,108881269,108896889,108912273,108928255,108943124,108957907,108970254,108982901,108996183,109008773,109023528,109037638,109050620,109062265,109073715,109087245,109100401,109112952,109126778,109138983,109150300,109161921,109174738,109188574,109201805,109215340,109227493,109238687,109249607,109263677,109275677,109288681,109301913,109314204,109325702,109336740,109349666,109363410,109377814,109392884,109406377,109418753,109431305,109445958,109460655,109475776,109491905,109506272,109518886,109531742,109545206,109561408,109576084,109590132,109603544,109615414,109628569,109644903,109662542,109681892,109702046,109719999,109737058,109754404,109772866,109793468,109815373,109837491,109857638,109876822,109895507,109917102,109939602,109964535,109987218,110011363,110033247,110055423,110081541,110106935,110137437,110164109,110189215,110211576,110231761,110253457,110278192,110305136,110337958,110365729,110391838,110415754,110439528,110468622,110497867,110528591,110555541,110581430,110606087,110637369,110663418,110692947,110721641,110746415,110768181,110788528,110813302,110836491,110861185,110883899,110904928,110923904,110942503,110964290,110986020,111007808,111030632,111050295,111067375,111086225,111106304,111126394,111148097,111168543,111187108,111203580,111220270,111237676,111258669,111277783,111296562,111314518,111329098,111344001,111362491,111379413,111396411,111412589,111427343,111439970,111451907,111465496,111480196,111494740,111509380,111522964,111533860,111544727,111557920,111569833,111582262,111593558,111603990,111612383,111620785,111630676,111639660,111649158,111657929,111665674,111672084,111678560,111686126,111693204,111700147,111706661,111712784,111717610,111722494,111728765,111734432,111740565,111746229,111751567,111755791,111759950,111765136,111770850,111775361,111779757,111783741,111787281,111790730,111794325,111797706,111800893,111804483,111807609,111809940,111812271,111814632,111817187,111818931,111820082];
n_total_case = len(total_case);

calendar = [i.split(" ")[2]+"-"+str(month_dict[i.split(" ")[0]])+"-"+i.split(" ")[1][0:-1] \
            for i in df_calendar.columns];
n_calendar = len(calendar);
total_case = total_case[0:n_calendar];
n_total_case = len(total_case);
index_total_case = [date_to_index(i, user_calendar_start = calendar_start) for i in calendar];


####################################
df_active_and_total_case = pandas.DataFrame({'Index': index_total_case, \
                                             'Active-Case': active_case, \
                                             'Total-Case': total_case});
df_active_and_total_case = df_active_and_total_case[df_active_and_total_case['Index'] >= 0];

index_total_case = list(df_active_and_total_case['Index']);
total_case = list(df_active_and_total_case['Total-Case']);
active_case = list(df_active_and_total_case['Active-Case']); 
n_total_case = len(total_case)
susceptible = [N_p - total_case[i] for i in range(n_total_case)];
##
index_dt = [i for i in t_samples];
active_case_dt = [];
susceptible_dt = [];
f_active = np.interp(index_dt, index_total_case, active_case);
f_susceptible = np.interp(index_dt, index_total_case, susceptible);
##
active_case_dt = f_active;
susceptible_dt = f_susceptible;
##
n = len(index_dt);

##
decimal = ['25', '5', '75'];

mu = [];
for i in index_dt:
    if (i in index_total_case) or (str(i).split('.')[1] in decimal):
        mu.append(1);
    else:
        mu.append(0);

n = len(index_dt);

recovered_dt = [N_p - susceptible_dt[i] - active_case_dt[i] for i in range(n)];

final_df = pandas.DataFrame({'Index': index_dt, \
                             'S': susceptible_dt, \
                             'I': active_case_dt, \
                             'Mu': mu, \
                             'R': recovered_dt});

if save_data:
    final_df['Index'].to_csv('index_ready_' + country_ID + '.csv', index=False);
    final_df['S'].to_csv('S_ready_' + country_ID + '.csv', index=False);
    final_df['I'].to_csv('I_ready_' + country_ID + '.csv', index=False);
    final_df['Mu'].to_csv('Mu_ready_' + country_ID + '.csv', index=False);
    final_df['R'].to_csv('R_ready_' + country_ID + '.csv', index=False);


fig, ax = plt.subplots();
ax.plot(index_dt, susceptible_dt);
ax.set_title("Susceptible on the interval ["+calendar_start+","+calendar_target+"]."); 
fig.show()

fig, ax = plt.subplots();
ax.plot(index_dt, active_case_dt, '-', color='red');
ax.set_title("Active Cases (I) on the interval ["+calendar_start+","+calendar_target+"].");
fig.show()


